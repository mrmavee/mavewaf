# Network Configuration
LISTEN_ADDR=0.0.0.0:8080
INTERNAL_ADDR=127.0.0.1:8081
BACKEND_URL=http://127.0.0.1:9000

# WAF Configuration
# Modes: NORMAL (Minimal filtering), DEFENSE (Aggressive filtering with CAPTCHA)
WAF_MODE=NORMAL
WAF_BODY_SCAN_ENABLED=true
WAF_BODY_SCAN_MAX_SIZE=32768

# UI Configuration
APP_NAME=MaveWAF
LOGO_BASE64=

# SEO Meta Tags (for WAF pages: queue, captcha, error)
META_TITLE=Security Check
META_DESCRIPTION=Protected by MaveWAF - Secure Access Gateway
META_KEYWORDS="tor, waf, security, privacy"
LOG_FORMAT="json" # Options: json, pretty

# Rate Limiting
# Circuit Rate Limit (Layer 1)
RATE_LIMIT_RPS=6
RATE_LIMIT_BURST=10
# Session Rate Limit (Layer 2)
RATE_LIMIT_SESSION_RPS=3
RATE_LIMIT_SESSION_BURST=5

# Session Management
SESSION_SECRET=REPLACE_WITH_SECURE_32_BYTE_HEX_STRING
SESSION_EXPIRY_SECS=3600

# CAPTCHA Configuration
# Styles: Simple, Complex
CAPTCHA_ENABLED=true
CAPTCHA_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING
CAPTCHA_TTL=300
CAPTCHA_STYLE=Complex
CAPTCHA_DIFFICULTY=medium
MAX_CAPTCHA_FAILURES=3
CAPTCHA_GEN_LIMIT=5

# Tor Integration
TOR_CIRCUIT_PREFIX=fc00:dead:beef
TOR_CONTROL_ADDR=127.0.0.1:9051
TOR_CONTROL_PASSWORD=REPLACE_WITH_TOR_CONTROL_PASSWORD
TORRC_PATH=/etc/tor/torrc

# Defense Thresholds
DEFENSE_ERROR_RATE_THRESHOLD=0.15
DEFENSE_CIRCUIT_FLOOD_THRESHOLD=100
DEFENSE_COOLDOWN_SECS=300

# SSRF Protection
# Comma-separated list of allowed domains. Leave empty to block all external resource loads.
SSRF_ALLOWED_HOSTS=

# Webhook Notifications
WEBHOOK_ENABLED=false
WEBHOOK_URL=

# Logging
RUST_LOG=info

# I2P Integration
I2P_ENABLED=false

# Security Headers
# Extra CSP sources (e.g., "https://cdn.example.com https://fonts.example.com")
CSP_EXTRA_SOURCES=
# Cross-Origin-Opener-Policy: same-origin, same-origin-allow-popups, unsafe-none, or off
COOP_POLICY=same-origin-allow-popups
# Enable Cross-Origin-Embedder-Policy (require-corp)
COEP_ENABLED=false
